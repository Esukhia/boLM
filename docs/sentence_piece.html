---

title: Setup


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/train_tokenizers/sentence_piece.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/train_tokenizers/sentence_piece.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install sentencepiece

<span class="o">!</span>pip install nbd-colab

<span class="kn">from</span> <span class="nn">nbd_colab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">drive_setup</span><span class="p">()</span>
<span class="n">home_dir</span><span class="p">()</span>

<span class="n">repo_name</span> <span class="o">=</span> <span class="s1">&#39;bonltk&#39;</span>
<span class="n">change_dir</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/content/drive/My Drive/Notebooks/Esukhia/</span><span class="si">{</span><span class="n">repo_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Requirement already satisfied: sentencepiece in /usr/local/lib/python3.6/dist-packages (0.1.85)
Requirement already satisfied: nbd-colab in /usr/local/lib/python3.6/dist-packages (0.0.10)
Requirement already satisfied: fastcore in /usr/local/lib/python3.6/dist-packages (from nbd-colab) (0.1.16)
Requirement already satisfied: nbdev in /usr/local/lib/python3.6/dist-packages (from nbd-colab) (0.2.17)
Requirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from fastcore-&gt;nbd-colab) (1.18.2)
Requirement already satisfied: dataclasses&gt;=&#39;0.7&#39;; python_version &lt; &#34;3.7&#34; in /usr/local/lib/python3.6/dist-packages (from fastcore-&gt;nbd-colab) (0.7)
Requirement already satisfied: fastscript in /usr/local/lib/python3.6/dist-packages (from nbdev-&gt;nbd-colab) (0.1.4)
Requirement already satisfied: nbformat&gt;=4.4.0 in /usr/local/lib/python3.6/dist-packages (from nbdev-&gt;nbd-colab) (5.0.5)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.6/dist-packages (from nbdev-&gt;nbd-colab) (3.13)
Requirement already satisfied: nbconvert&gt;=5.6.1 in /usr/local/lib/python3.6/dist-packages (from nbdev-&gt;nbd-colab) (5.6.1)
Requirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from nbdev-&gt;nbd-colab) (20.3)
Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev-&gt;nbd-colab) (0.2.0)
Requirement already satisfied: jsonschema!=2.5.0,&gt;=2.4 in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev-&gt;nbd-colab) (2.6.0)
Requirement already satisfied: jupyter-core in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev-&gt;nbd-colab) (4.6.3)
Requirement already satisfied: traitlets&gt;=4.1 in /usr/local/lib/python3.6/dist-packages (from nbformat&gt;=4.4.0-&gt;nbdev-&gt;nbd-colab) (4.3.3)
Requirement already satisfied: jinja2&gt;=2.4 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (2.11.1)
Requirement already satisfied: testpath in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (0.4.4)
Requirement already satisfied: pygments in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (2.1.3)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (0.8.4)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (0.3)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (0.6.0)
Requirement already satisfied: bleach in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (3.1.4)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.6/dist-packages (from nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (1.4.2)
Requirement already satisfied: pyparsing&gt;=2.0.2 in /usr/local/lib/python3.6/dist-packages (from packaging-&gt;nbdev-&gt;nbd-colab) (2.4.7)
Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from packaging-&gt;nbdev-&gt;nbd-colab) (1.12.0)
Requirement already satisfied: decorator in /usr/local/lib/python3.6/dist-packages (from traitlets&gt;=4.1-&gt;nbformat&gt;=4.4.0-&gt;nbdev-&gt;nbd-colab) (4.4.2)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.6/dist-packages (from jinja2&gt;=2.4-&gt;nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (1.1.1)
Requirement already satisfied: webencodings in /usr/local/lib/python3.6/dist-packages (from bleach-&gt;nbconvert&gt;=5.6.1-&gt;nbdev-&gt;nbd-colab) (0.5.1)
Mounted at /content/drive
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Imports">Imports<a class="anchor-link" href="#Imports"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">sentencepiece</span> <span class="k">as</span> <span class="nn">spm</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Config">Config<a class="anchor-link" href="#Config"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.bonltk/data/corpora/esukhia-dergey-katen&#39;</span><span class="p">)</span>
<span class="n">corpus_fn</span> <span class="o">=</span> <span class="n">data_path</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;all-</span><span class="si">{</span><span class="n">data_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.txt&#39;</span>
<span class="n">tokenized_corpus_fn</span> <span class="o">=</span> <span class="n">data_path</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;all-</span><span class="si">{</span><span class="n">data_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">-tokenized.txt&#39;</span>

<span class="n">models_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.bonltk/models/tokenizers&#39;</span><span class="p">)</span>
<span class="n">models_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Prepare-Dataset">Prepare Dataset<a class="anchor-link" href="#Prepare-Dataset"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">undo_tokenization</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="p">[(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)]:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="k">def</span> <span class="nf">combine_files</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">out_fn</span><span class="p">,</span> <span class="n">pretokenized</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">corpus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">n_sentences</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">out_fn</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span> <span class="k">return</span> <span class="n">out_fn</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">source_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())):</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span> <span class="k">continue</span>
        <span class="n">sentences</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())):</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pretokenized</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">undo_tokenization</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">n_sentences</span> <span class="o">+=</span> <span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">corpus</span> <span class="o">+=</span> <span class="n">text</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[INFO] No. sentences the courpus contains:&#39;</span><span class="p">,</span> <span class="n">n_sentences</span><span class="p">)</span>
    <span class="n">out_fn</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out_fn</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">combine_files</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">corpus_fn</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>


[INFO] No. sentences the courpus contains: 2990486
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;.bonltk/data/corpora/esukhia-dergey-katen/all-esukhia-dergey-katen.txt&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head <span class="o">{</span>corpus_fn<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>༄༅། །འདུལ་བ་ང་བཞུགས་སོ།།༄༅༅། །
འདུལ་བ་གཞི། བམ་པོ་བརྒྱད་བཅུ་གསུམ་པ། གཟིགས་ནས་
ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།
ལྷ་འདི་ནི་བྲོ་འཚལ་བ་ཞེས་བགྱིའོ། །
ཁ་ལོ་སྒྱུར་བ་ནད་ཀྱིས་ཐེབས་པ་ཞེས་བྱ་བ་འདི་ཅི་ཡིན།
ལྷ་མི་འདི་གང་འདིས་འགུམ་པར་འགྱུར་བའི་གནས་དེ་མཆིས་ཏེ།
ལྷ་འདི་ནི་བྲོས་ཐེབས་པ་ཞེས་བགྱིའོ། །
ཁ་ལོ་སྒྱུར་བ་ང་ཡང་ནད་ཀྱི་ཆོས་དང་ནད་ཀྱི་ཆོས་ཉིད་ལས་མ་འདས་སམ། ལྷ་ཡང་སྙུན་གྱི་ཆོས་དང་སྙུན་གྱི་ཆོས་ཉིད་ལས་མ་འདས་སོ། །
ཁ་ལོ་སྒྱུར་བ་དེའི་ཕྱིར་ཤིང་རྟ་ཕྱིར་སྒྱུར་ཅིག་ཕོ་བྲང་ཉིད་དུ་འདོང་ངོ་། །
འདི་ལྟར་ང་ཕོ་བྲང་ཉིད་དུ་ཕྱིན་ནས་ང་ནད་ལས་མ་འདས་ཞེས་གྲགས་པའི་དོན་དེ་ཉིད་བསམ་པར་བྱའོ། །
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">combine_files</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">tokenized_corpus_fn</span><span class="p">,</span> <span class="n">pretokenized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>


</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;.bonltk/data/corpora/esukhia-dergey-katen/all-esukhia-dergey-katen-tokenized.txt&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tail <span class="o">{</span>tokenized_corpus_fn<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>དགའ་བ་ ནི་ ཤིན་ཏུ་ སྦྱངས་པ་ དང་ ལྡན་པ ར་ བྱེད་ དེ །
ཡིད་ དགའ་བ འི་ ལུས་ ཤིན་ཏུ་ སྦྱངས་པ ར་ འགྱུར་ རོ་ ཞེས་ འབྱུང་བ འི་ ཕྱིར་ རོ །_། ལུས་ མཉེན་པ ར་ བྱེད་པ་ ཞེས་ བྱ་བ་ ནི་ལ ས་ སུ་ རུང་བ ར་ བྱེད་པ འོ །_།
དེ་ཉིད་ ཀྱི་ ཕྱིར་ ཞེས་ བྱ་བ་ ནི་ ལུས་ མཉེན་པ ར་ བྱེད་པ འི་ ཕྱིར་ ཞེས་ བྱ་བ འི་ ཐ་ཚིག་ གོ །_།
བཞི་པ་ ན་ མེད་ མི་ གཡོ་ ཕྱིར །_། ཞེས་ བྱ་བ་ ནི་ མི་ འགུལ་ ཞེས་ བྱ་བ འི་ དོན་ ཏོ །_། ནང་ གི་ སྐྱོན་ དང་ བྲལ་བ འི་ ཕྱིར །_། ཞེས་ བྱ་བ་ ལ །_ རྟོག་ དང་ དཔྱོད་ དང་ དབུགས་ དག་ དང་ །_། བདེ་བ་ ལ་སོགས་ བཞི་ ཡིན་ ནོ །_། ཞེས་ རྟོག་པ་ དང་ དཔྱོད་པ་ ལ་སོགས་པ་ རྣམས་ སྐྱོན་ དུ་ འཆད་པ ར་ འགྱུར་ རོ །_། དེ་དག་ གིས་ གཟུགས་ མེད་པ་ དག་ ཏུ་ འཇུག་པ ར་ མི་ ནུས་ ལ་ ཞེས་ བྱ་བ་ ནི་ གནས་ གཙང་མ་ རྣམས་ ལྷག་མཐོང་ སྤྱོད་པ་ ཡིན་པ འི་ ཕྱིར་ ལ །_ དེ་དག་ ནི་ ཞི་གནས་ ལྷག་པ་ ཡིན་པ འི་ ཕྱིར་ རོ །_། གཞན་ དུ་ ཡང་ འགྲོ་བ ར་ མི་ ནུས་ སོ་ ཞེས་ བྱ་བ་ ནི་ ས་འོག་ མར་ སྟེ །
ཕྱིར་ མི་ འོང་བ་ རྣམས་ ཁྱད་པར་ དུ་ འགྲོ་བ་ ཡིན་པ འི་ ཕྱིར་ རོ །_། ཅིའི་ཕྱིར་ དུས་ཡུན་ རིང་མོ་ ཞིག་ ན་ ཆུས་ འཇིག་ ལ །_ དེ་བ ས་ ཀྱང་ ཆེས་ རིང་བ་ ན་ རླུང་ གིས་ འཇིག་ ཅེ་ ན །
དེ འི་ ཕྱིར་ སེམས་ཅན་ དེ་དག་ གི་ སྙོམས་པར་ འཇུག་པ འི་ ཁྱད་པར་ ལ ས་ ཞེས་ བྱ་བ་ རྒྱས་པ ར་ སྨོས་ ཏེ །
སྙོམས་པར་ འཇུག་པ འི་ ཁྱད་པར་ ནི་ བསམ་གཏན་ གཉིས་པ་ དང་ །_ གསུམ་པ འི་ ཁྱད་པར་ རོ །_། ལུས་ གནས་པ འི་ ཁྱད་པར་ ཞེས་ བྱ་བ་ ནི་ གསོན་པ འི་ རྒྱུན་ གྱི་ ཁྱད་པར་ ཏེ །
དུས་ དེ་ཙམ་ གྱིས་ དེ་དག་ གི་ ཚེ་ཟད་པ ར་ འགྱུར་ རོ །_། འཇིག་པ་ དེ་དག་ ནི་ དྲུག་ཅུ་ རྩ་ བཞི ར་ འགྱུར་ ལ །_ འཇིག་པ་ རེ་རེ་ ཡང་ བསྐལ་པ་ ཆེན་པོ་ ཡིན་ ནོ །_། དེ་ཉིད་ ཀྱི་ ཕྱིར་ དེ་ལྟར་ བཤད་ ན་
བརྟགས་པ འི་ བཤད་པ་ ཞེས་ བྱ་བ་ རྒྱས་པ ར་ སྨོས་ སོ །_།
སློབ་དཔོན་ གང་བ་ སྤེལ་བ ས་ མཛད་པ་ ཆོས་ མངོན་པ་ མཛོད་ ཀྱི་ འགྲེལ་བཤད་ མཚན་ཉིད་ ཀྱི་ རྗེས་སུ་ འབྲང་བ་ ཞེས་ བྱ་བ་ ལ ས །_ འཇིག་རྟེན་ བསྟན་པ་ ཞེས་ བྱ་བ་ མཛོད་ ཀྱི་ གནས་ གསུམ་པ འི་ འགྲེལ་བཤད་ དོ །།_།།</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat <span class="o">{</span>corpus_fn<span class="o">}</span> <span class="p">|</span> wc -l
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2990486
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Train-sentencepie-model">Train sentencepie model<a class="anchor-link" href="#Train-sentencepie-model"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;classical&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_sp</span><span class="p">(</span><span class="n">input_fn</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;unigram&#39;</span><span class="p">):</span>
    <span class="n">model_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s1">&#39;</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">models_path</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_prefix</span><span class="si">}</span><span class="s1">.model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">models_path</span><span class="o">/</span><span class="n">model_prefix</span>

    <span class="n">spm</span><span class="o">.</span><span class="n">SentencePieceTrainer</span><span class="o">.</span><span class="n">Train</span><span class="p">(</span>
    <span class="sa">f</span><span class="s1">&#39;--input=</span><span class="si">{</span><span class="n">input_fn</span><span class="si">}</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">      --model_prefix=</span><span class="si">{</span><span class="n">model_prefix</span><span class="si">}</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">      --vocab_size=30000 </span><span class="se">\</span>
<span class="s1">      --model_type=</span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s1"> </span><span class="se">\</span>
<span class="s1">      --character_coverage=0.9998 </span><span class="se">\</span>
<span class="s1">      --unk_id=0 </span><span class="se">\</span>
<span class="s1">      --pad_id=-1 </span><span class="se">\</span>
<span class="s1">      --bos_id=-1 </span><span class="se">\</span>
<span class="s1">      --eos_id=-1&#39;</span>
    <span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mv </span><span class="si">{</span><span class="n">model_prefix</span><span class="si">}</span><span class="s1">.* </span><span class="si">{</span><span class="n">models_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">models_path</span><span class="o">/</span><span class="n">model_prefix</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Word-base-model---tokenized-by-botok">Word base model - tokenized by botok<a class="anchor-link" href="#Word-base-model---tokenized-by-botok"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_path</span> <span class="o">=</span> <span class="n">get_sp</span><span class="p">(</span><span class="n">tokenized_corpus_fn</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">)</span>

<span class="n">sp</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">SentencePieceProcessor</span><span class="p">()</span>
<span class="n">sp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s1">.model&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཡིད་ དགའ་བ འི་ ལུས་ ཤིན་ཏུ་ སྦྱངས་པ ར་ འགྱུར་ རོ་ ཞེས་ འབྱུང་བ འི་ ཕྱིར་ རོ །_། ལུས་ མཉེན་པ ར་ བྱེད་པ་ ཞེས་ བྱ་བ་ ནི་ལ ས་ སུ་ རུང་བ ར་ བྱེད་པ འོ །_།&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_ids</span><span class="p">(</span><span class="s1">&#39;ཡིད་ དགའ་བ འི་ ལུས་ ཤིན་ཏུ་ སྦྱངས་པ ར་ འགྱུར་ རོ་ ཞེས་ འབྱུང་བ འི་ ཕྱིར་ རོ །_། ལུས་ མཉེན་པ ར་ བྱེད་པ་ ཞེས་ བྱ་བ་ ནི་ལ ས་ སུ་ རུང་བ ར་ བྱེད་པ འོ །_།&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁ཡིད་&#39;, &#39;▁དགའ་བ&#39;, &#39;▁འི་&#39;, &#39;▁ལུས་&#39;, &#39;▁ཤིན་ཏུ་&#39;, &#39;▁སྦྱངས་པ&#39;, &#39;▁ར་&#39;, &#39;▁འགྱུར་&#39;, &#39;▁རོ་&#39;, &#39;▁ཞེས་&#39;, &#39;▁འབྱུང་བ&#39;, &#39;▁འི་&#39;, &#39;▁ཕྱིར་&#39;, &#39;▁རོ&#39;, &#39;▁།_།&#39;, &#39;▁ལུས་&#39;, &#39;▁མཉེན་པ&#39;, &#39;▁ར་&#39;, &#39;▁བྱེད་པ་&#39;, &#39;▁ཞེས་&#39;, &#39;▁བྱ་བ་&#39;, &#39;▁ནི་ལ&#39;, &#39;▁ས་&#39;, &#39;▁སུ་&#39;, &#39;▁རུང་བ&#39;, &#39;▁ར་&#39;, &#39;▁བྱེད་པ&#39;, &#39;▁འོ&#39;, &#39;▁།_།&#39;]
[123, 373, 5, 106, 160, 2156, 6, 45, 162, 15, 199, 5, 29, 44, 4, 106, 6939, 6, 79, 15, 22, 1301, 9, 40, 726, 6, 104, 16, 4]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_ids</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ།▁ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ།▁སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;]
[3]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Unigram-model">Unigram model<a class="anchor-link" href="#Unigram-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_path</span> <span class="o">=</span> <span class="n">get_sp</span><span class="p">(</span><span class="n">corpus_fn</span><span class="p">,</span> <span class="n">model_name</span><span class="p">)</span>

<span class="n">sp</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">SentencePieceProcessor</span><span class="p">()</span>
<span class="n">sp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s1">.model&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_ids</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁ཀྱང་&#39;, &#39;ཁ་ལོ་སྒྱུར་བ་&#39;, &#39;ལ་&#39;, &#39;གསུངས་པ།&#39;, &#39;▁&#39;, &#39;ཁ་ལོ་སྒྱུར་བ་&#39;, &#39;མི་&#39;, &#39;སྐྱ་&#39;, &#39;བོ་&#39;, &#39;རྦ&#39;, &#39;བ་&#39;, &#39;རྦ&#39;, &#39;བ་&#39;, &#39;པོ་&#39;, &#39;རིད་&#39;, &#39;པ་&#39;, &#39;ཉམ་ཆུང་བ&#39;, &#39;་&#39;, &#39;དབང་པོ་&#39;, &#39;ཉམས་པ&#39;, &#39;།&#39;, &#39;▁&#39;, &#39;སྐྱེ་བོ་མང་པོའི་&#39;, &#39;མིག་གིས་&#39;, &#39;ཀྱང་&#39;, &#39;ལྟ་&#39;, &#39;མི་ཕོད&#39;, &#39;་པ་&#39;, &#39;འདི་&#39;, &#39;ཅི་&#39;, &#39;ཡིན།&#39;]
[45, 13335, 62, 1577, 25, 13335, 167, 8113, 1608, 7613, 132, 7613, 132, 408, 21432, 91, 13213, 21, 1181, 5271, 38, 25, 29883, 7110, 324, 2867, 19799, 4799, 269, 914, 533]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཁ་ལོ་སྒྱུར་བ་ང་ཡང་ནད་ཀྱི་ཆོས་དང་ནད་ཀྱི་ཆོས་ཉིད་ལས་མ་འདས་སམ། ལྷ་ཡང་སྙུན་གྱི་ཆོས་དང་སྙུན་གྱི་ཆོས་ཉིད་ལས་མ་འདས་སོ། །&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁&#39;, &#39;ཁ་ལོ་སྒྱུར་བ་&#39;, &#39;ང་&#39;, &#39;ཡང་&#39;, &#39;ནད་ཀྱི་&#39;, &#39;ཆོས་དང་&#39;, &#39;ནད་&#39;, &#39;ཀྱི་ཆོས་ཉིད་&#39;, &#39;ལས་མ་འདས་&#39;, &#39;སམ།&#39;, &#39;▁ལྷ་&#39;, &#39;ཡང་&#39;, &#39;སྙུན་&#39;, &#39;གྱི་ཆོས་&#39;, &#39;དང་&#39;, &#39;སྙུན་&#39;, &#39;གྱི་&#39;, &#39;ཆོས་ཉིད་&#39;, &#39;ལས་མ་འདས་&#39;, &#39;སོ།&#39;, &#39;▁།&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="BPE-(Byte-pair-encoding)-model">BPE (Byte pair encoding) model<a class="anchor-link" href="#BPE-(Byte-pair-encoding)-model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_path</span> <span class="o">=</span> <span class="n">get_sp</span><span class="p">(</span><span class="n">corpus_fn</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;bpe&#39;</span><span class="p">)</span>

<span class="n">sp</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">SentencePieceProcessor</span><span class="p">()</span>
<span class="n">sp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s1">.model&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_ids</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁ཀྱང་&#39;, &#39;ཁ་ལོ་སྒྱུར་བ་&#39;, &#39;ལ་&#39;, &#39;གསུངས་པ།&#39;, &#39;▁ཁ་ལོ་&#39;, &#39;སྒྱུར་བ་&#39;, &#39;མི་&#39;, &#39;སྐྱ&#39;, &#39;་བོ་&#39;, &#39;རྦ&#39;, &#39;བ་&#39;, &#39;རྦ&#39;, &#39;བ་&#39;, &#39;པོ་&#39;, &#39;ར&#39;, &#39;ིད་པ་&#39;, &#39;ཉམ་&#39;, &#39;ཆུང་བ་&#39;, &#39;དབང་པོ་&#39;, &#39;ཉམས་&#39;, &#39;པ།&#39;, &#39;▁སྐྱེ་བོ་&#39;, &#39;མང་པོའི་&#39;, &#39;མིག་གིས་&#39;, &#39;ཀྱང་&#39;, &#39;ལྟ་&#39;, &#39;མི་&#39;, &#39;ཕོད་པ་&#39;, &#39;འདི་ཅི་&#39;, &#39;ཡིན།&#39;]
[234, 26573, 15, 2935, 9094, 11166, 190, 303, 2948, 1136, 17, 1136, 17, 68, 29935, 6281, 8008, 6292, 1576, 1690, 523, 1722, 7866, 7788, 361, 392, 190, 24202, 19458, 898]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཁ་ལོ་སྒྱུར་བ་ང་ཡང་ནད་ཀྱི་ཆོས་དང་ནད་ཀྱི་ཆོས་ཉིད་ལས་མ་འདས་སམ། ལྷ་ཡང་སྙུན་གྱི་ཆོས་དང་སྙུན་གྱི་ཆོས་ཉིད་ལས་མ་འདས་སོ། །&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁ཁ་ལོ་&#39;, &#39;སྒྱུར་བ་&#39;, &#39;ང་ཡང་&#39;, &#39;ནད་ཀྱི་&#39;, &#39;ཆོས་དང་&#39;, &#39;ནད་ཀྱི་&#39;, &#39;ཆོས་ཉིད་&#39;, &#39;ལས་མ་འདས་&#39;, &#39;སམ།&#39;, &#39;▁ལྷ་&#39;, &#39;ཡང་&#39;, &#39;སྙུན་&#39;, &#39;གྱི་&#39;, &#39;ཆོས་དང་&#39;, &#39;སྙུན་&#39;, &#39;གྱི་&#39;, &#39;ཆོས་ཉིད་&#39;, &#39;ལས་མ་འདས་&#39;, &#39;སོ།&#39;, &#39;▁།&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Character-Model">Character Model<a class="anchor-link" href="#Character-Model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_path</span> <span class="o">=</span> <span class="n">get_sp</span><span class="p">(</span><span class="n">corpus_fn</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;char&#39;</span><span class="p">)</span>

<span class="n">sp</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">SentencePieceProcessor</span><span class="p">()</span>
<span class="n">sp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s1">.model&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_pieces</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">encode_as_ids</span><span class="p">(</span><span class="s1">&#39;ཀྱང་ཁ་ལོ་སྒྱུར་བ་ལ་གསུངས་པ། ཁ་ལོ་སྒྱུར་བ་མི་སྐྱ་བོ་རྦབ་རྦབ་པོ་རིད་པ་ཉམ་ཆུང་བ་དབང་པོ་ཉམས་པ། སྐྱེ་བོ་མང་པོའི་མིག་གིས་ཀྱང་ལྟ་མི་ཕོད་པ་འདི་ཅི་ཡིན།&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;▁&#39;, &#39;ཀ&#39;, &#39;ྱ&#39;, &#39;ང&#39;, &#39;་&#39;, &#39;ཁ&#39;, &#39;་&#39;, &#39;ལ&#39;, &#39;ོ&#39;, &#39;་&#39;, &#39;ས&#39;, &#39;ྒ&#39;, &#39;ྱ&#39;, &#39;ུ&#39;, &#39;ར&#39;, &#39;་&#39;, &#39;བ&#39;, &#39;་&#39;, &#39;ལ&#39;, &#39;་&#39;, &#39;ག&#39;, &#39;ས&#39;, &#39;ུ&#39;, &#39;ང&#39;, &#39;ས&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;།&#39;, &#39;▁&#39;, &#39;ཁ&#39;, &#39;་&#39;, &#39;ལ&#39;, &#39;ོ&#39;, &#39;་&#39;, &#39;ས&#39;, &#39;ྒ&#39;, &#39;ྱ&#39;, &#39;ུ&#39;, &#39;ར&#39;, &#39;་&#39;, &#39;བ&#39;, &#39;་&#39;, &#39;མ&#39;, &#39;ི&#39;, &#39;་&#39;, &#39;ས&#39;, &#39;ྐ&#39;, &#39;ྱ&#39;, &#39;་&#39;, &#39;བ&#39;, &#39;ོ&#39;, &#39;་&#39;, &#39;ར&#39;, &#39;ྦ&#39;, &#39;བ&#39;, &#39;་&#39;, &#39;ར&#39;, &#39;ྦ&#39;, &#39;བ&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;ོ&#39;, &#39;་&#39;, &#39;ར&#39;, &#39;ི&#39;, &#39;ད&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;་&#39;, &#39;ཉ&#39;, &#39;མ&#39;, &#39;་&#39;, &#39;ཆ&#39;, &#39;ུ&#39;, &#39;ང&#39;, &#39;་&#39;, &#39;བ&#39;, &#39;་&#39;, &#39;ད&#39;, &#39;བ&#39;, &#39;ང&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;ོ&#39;, &#39;་&#39;, &#39;ཉ&#39;, &#39;མ&#39;, &#39;ས&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;།&#39;, &#39;▁&#39;, &#39;ས&#39;, &#39;ྐ&#39;, &#39;ྱ&#39;, &#39;ེ&#39;, &#39;་&#39;, &#39;བ&#39;, &#39;ོ&#39;, &#39;་&#39;, &#39;མ&#39;, &#39;ང&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;ོ&#39;, &#39;འ&#39;, &#39;ི&#39;, &#39;་&#39;, &#39;མ&#39;, &#39;ི&#39;, &#39;ག&#39;, &#39;་&#39;, &#39;ག&#39;, &#39;ི&#39;, &#39;ས&#39;, &#39;་&#39;, &#39;ཀ&#39;, &#39;ྱ&#39;, &#39;ང&#39;, &#39;་&#39;, &#39;ལ&#39;, &#39;ྟ&#39;, &#39;་&#39;, &#39;མ&#39;, &#39;ི&#39;, &#39;་&#39;, &#39;ཕ&#39;, &#39;ོ&#39;, &#39;ད&#39;, &#39;་&#39;, &#39;པ&#39;, &#39;་&#39;, &#39;འ&#39;, &#39;ད&#39;, &#39;ི&#39;, &#39;་&#39;, &#39;ཅ&#39;, &#39;ི&#39;, &#39;་&#39;, &#39;ཡ&#39;, &#39;ི&#39;, &#39;ན&#39;, &#39;།&#39;]
[5, 27, 17, 19, 4, 37, 4, 22, 11, 4, 6, 35, 17, 21, 12, 4, 9, 4, 22, 4, 10, 6, 21, 19, 6, 4, 15, 16, 5, 37, 4, 22, 11, 4, 6, 35, 17, 21, 12, 4, 9, 4, 18, 7, 4, 6, 39, 17, 4, 9, 11, 4, 12, 51, 9, 4, 12, 51, 9, 4, 15, 11, 4, 12, 7, 8, 4, 15, 4, 32, 18, 4, 30, 21, 19, 4, 9, 4, 8, 9, 19, 4, 15, 11, 4, 32, 18, 6, 4, 15, 16, 5, 6, 39, 17, 14, 4, 9, 11, 4, 18, 19, 4, 15, 11, 20, 7, 4, 18, 7, 10, 4, 10, 7, 6, 4, 27, 17, 19, 4, 22, 26, 4, 18, 7, 4, 31, 11, 8, 4, 15, 4, 20, 8, 7, 4, 28, 7, 4, 23, 7, 13, 16]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Save-the-model">Save the model<a class="anchor-link" href="#Save-the-model"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install nbd-colab

<span class="kn">from</span> <span class="nn">nbd_colab</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">drive_setup</span><span class="p">()</span>
<span class="n">home_dir</span><span class="p">()</span>

<span class="n">repo_name</span> <span class="o">=</span> <span class="s1">&#39;bonltk&#39;</span>
<span class="n">change_dir</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;/content/drive/My Drive/Notebooks/Esukhia/</span><span class="si">{</span><span class="n">repo_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

